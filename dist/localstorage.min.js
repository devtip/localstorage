!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("ClientStorage requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(){var e=l.createElement("input");return e.type="hidden",e.addBehavior("#default#userData"),l.body.appendChild(e),e}function r(e,t){try{var r=n(),i=t||{};if(i.expires){var u;"number"==typeof i.expires&&(u=new Date,u.setTime(u.getTime()+i.expires)),r.expires=u.toUTCString()}r.setAttribute(i.key,i.value),r.save(i.key)}catch(e){}}function i(e,t){r(e,t);var n=u({key:m});n=n?{key:m,value:n}:{key:m,value:""},new RegExp("(^|\\|)"+e+"(\\||$)","g").test(n.value)||(n.value+="|"+e,r(m,n))}function u(e){try{var t=n();return t.load(e.key),t.getAttribute(e.key)||null}catch(e){return null}}function o(e){try{var t=n();t.load(e.key),t.removeAttribute(e.key);var i=new Date;i.setTime(i.getTime()-1),t.expires=i.toUTCString(),t.save(e.key);var o=u({key:m});o&&(o=o.replace(new RegExp("(^|\\|)"+e.key+"(\\||$)","g"),""),o={key:m,value:o},r(m,o))}catch(e){}}function a(){if(result=u({key:m}),result)for(var e=result.split("|"),t=e.length,n=0;n<t;n++)e[n]&&o({key:e[n]})}function f(){var e=[],t=u({key:m});if(t){t=t.split("|");for(var n=0,r=t.length;n<r;n++)t[n]&&e.push(t[n])}return e}var l=e.document,c=Object.prototype,s=c.toString,y=function(e){return/native code/.test(e)},v=Array.isArray||function(e){return"[object Array]"===s.call(e)},p=e.localStorage,d=!!p&&y(p.constructor),g=!e.dispatchEvent&&!d,k=function(e){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)},m="_baidu.ALL.KEY_",x=function(){return d?function(e){if(k(e.key)){var t=e||{};if(p.setItem(t.key,t.value),e.expires){var n;"number"==typeof t.expires&&(n=new Date,n.setTime(n.getTime()+t.expires)),p.setItem(t.key+".expires",n)}}}:g?function(e){if(k(config.key)){var t=config||{};i(config.key,t)}}:void 0}(),h=function(e){return d?function(e){var t=null;if("string"==typeof e&&(e={key:e}),!k(e.key))return t;if(t=p.getItem(e.key)){var n=p.getItem(e.key+".expires");t={value:t,expires:n?new Date(n):null},t&&t.expires&&t.expires<new Date&&(t=null,p.removeItem(e.key),p.removeItem(e.key+".expires"))}return t?t.value:null}:g?function(e){var t=null;return"string"==typeof e&&(e={key:e}),k(e.key)?(t=u(e),t&&(t={value:t}),t?t.value:null):t}:void 0}(),w=function(){return d?function(e){p.removeItem(e.key),p.removeItem(e.key+".expires")}:g?function(e){o(e)}:void 0}(),b={set:function(e){if(v(e))for(var t=0,n=e.length;t<n;t++)x(e[t]);else e&&x(e)},get:function(e){var t=null;if(v(e)){t=[];for(var n=0,r=e.length;n<r;n++)t.push(h(e[n]))}else e&&(t=h(e));return t},remove:function(e){if(v(e))for(var t=0,n=e.length;t<n;t++)w(e[t]);else e&&w(e)},clearAll:function(){p.clear()},getAllKeys:function(){for(var e,t=[],n=0,r=p.length;n<r;n++)if(e=p.key(n),!/.+\.expires$/.test(e))return t.push(e),t}};return g&&(b.clearAll=function(){a()},b.getAllKeys=function(){return f()}),"function"==typeof define&&define.amd&&define("clientstorage",[],function(){return b}),t||(e.ClientStorage=b),b});